<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxe Properties - Villa Clara</title>
    <link rel="stylesheet" href="../../../assets/styles/main.css">
    <link rel="stylesheet" href="../../../assets/styles/components/accordion.css">
    <link rel="stylesheet" href="../../../assets/styles/components/category-tree.css">
    <link rel="stylesheet" href="../../../assets/styles/components/card.css">
    <link rel="stylesheet" href="../../../assets/styles/components/modal.css">
    <link rel="stylesheet" href="../../../assets/styles/components/search.css">
    <link rel="stylesheet" href="../../../assets/styles/components/contacts.css">
    <link rel="stylesheet" href="../../../assets/styles/components/layout.css">
    <link rel="stylesheet" href="../../../assets/styles/components/services.css">
    <link rel="stylesheet" href="../../../styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>
<body>
    <div class="container">
        <!-- Botón flotante de retorno -->
        <button class="back-to-menu-float" id="back-to-menu-float">
            <i class="fas fa-arrow-left"></i>
            Back to Categories
        </button>
        <header class="main-header">
            <div class="logo-container">
                <img src="/assets/images/logo.png" alt="Luxe Properties Logo" class="logo">
            </div>
        </header>

        <main>
            <div class="property-welcome">
                <img src="" alt="" class="property-image">
                <h1 id="propertyTitle"></h1>
                <h3></h3>
                <div class="property-actions">
                    <a href="/index.html" class="back-to-home">
                        <i class="fas fa-home"></i>
                        <span>Back to home</span>
                    </a>
                    <button class="view-map-btn" id="openMapButton">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>View Location</span>
                    </button>
                </div>
            </div>

            <!-- Modal para el mapa -->
            <div id="mapModal" class="modal">
                <div class="modal-content">
                    <span class="close" id="closeMapButton">&times;</span>
                    <h2>Property Location</h2>
                    <div class="map-instructions">Pinch or use mouse wheel to zoom, drag to pan around the map</div>
                    <style>
                        #mapModal {
                            position: fixed;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            background: rgba(0, 0, 0, 0.8);
                            display: none;
                            justify-content: center;
                            align-items: center;
                            z-index: 1000;
                        }

                        #mapModal .modal-content {
                            background: white;
                            padding: 20px;
                            border-radius: 8px;
                            width: 95%;
                            height: 95%;
                            position: relative;
                            display: flex;
                            flex-direction: column;
                            gap: 10px;
                        }

                        .map-container {
                            flex: 1;
                            position: relative;
                            background: #f5f5f5;
                            overflow: hidden;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            border-radius: 4px;
                            touch-action: none;
                        }

                        #propertyMapImage {
                            width: 100%;
                            height: 100%;
                            object-fit: contain;
                            transform-origin: center;
                            will-change: transform;
                            transition: transform 0.1s ease-out;
                        }

                        .map-instructions {
                            text-align: center;
                            color: #666;
                            font-size: 0.9rem;
                            margin: 5px 0;
                            animation: fadeOut 5s forwards;
                            animation-delay: 3s;
                        }

                        @keyframes fadeOut {
                            to {
                                opacity: 0;
                                visibility: hidden;
                            }
                        }
                        

                        .map-container.zoomed #propertyMapImage {
                            cursor: grab;
                        }

                        .map-container.panning #propertyMapImage {
                            cursor: grabbing;
                            transition: none;
                        }
                    </style>
                    <div class="map-wrapper">
                        <div class="map-instructions">
                            Usa los botones + y - para hacer zoom, o arrastra para mover el mapa
                        </div>
                        <div id="mapContainer" class="map-container">
                            <img id="propertyMapImage" src="" alt="Property Map">
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-button" id="zoomInBtn" title="Acercar">+</button>
                            <button class="zoom-button" id="zoomOutBtn" title="Alejar">-</button>
                            <button class="zoom-button" id="resetZoomBtn" title="Restablecer zoom">↺</button>
                        </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agregar panzoom -->
            <script src="https://unpkg.com/@panzoom/panzoom@4.5.1/dist/panzoom.min.js"></script>
                    </div>
                </div>
            </div>

            <div class="two-column-layout">
                <!-- Columna de información de la propiedad -->
                <div class="property-column">
                    <div class="property-hero">
                        <div class="property-info">
                            <div class="info-section">
                                <h2>Property Information</h2>
                                <div class="info-group">
                                    <h3>Wifi Information</h3>
                                    <ul class="info-list" style="list-style: none;">
                                        <!-- WiFi information will be inserted dynamically -->
                                    </ul>
                                </div>
                                
                                <div class="info-group">
                                    <h3>Parking Information</h3>
                                    <ul class="info-list" style="list-style: none;">
                                        <!-- Parking information will be inserted dynamically -->
                                    </ul>
                                </div>

                                <div class="info-group">
                                    <h3>Important Villa Information</h3>
                                    <!-- Important Villa Information will be inserted dynamically -->
                                </div>

                                <div class="info-group warning">
                                    <h3>St. Regis Hotel Note</h3>
                                    <p>PLEASE NOTE THAT FOR ALL RESIDENCES AT BAHIA BEACH RESORT, THE ST. REGIS' POOL AREA IS UNAVAILABLE AND THE RESTAURANT RESTRICTS RESERVATIONS WHEN THE HOTEL HAS HIGH OCCUPANCY.</p>
                                    <p>YOU WILL STILL HAVE FULL ACCESS TO THREE OTHER BEAUTIFUL AND MORE EXCLUSIVE MEMBERS' POOLS (TWO WITH FULL SERVICE,) BEACHES AND RESTAURANTS ESPECIALLY DEDICATED FOR MEMBERS AND RESIDENTS.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Columna del menú -->
                <div class="menu-column">
                    <h2>Services Book</h2>
                    <div class="search-container">
                        <input type="text" id="global-search" placeholder="Buscar contactos...">
                        <i class="material-icons search-icon">search</i>
                    </div>
                    <section id="sections-menu">
                        <div id="phonebook" class="sections-grid"></div>
                    </section>
                    <section id="contacts-display" class="hidden">
                        <div class="contacts-header">
                            <h2 id="current-category-title">Contactos</h2>
                        </div>
                        <div id="contacts-list" class="scrollable-list"></div>
                        <!-- Botón de retorno original oculto -->
                        <button id="back-to-menu" class="back-button" style="display: none;">
                            <i class="material-icons">arrow_back</i>
                            Back to Categories
                        </button>
                    </section>
                </div>
                
            </div>

            <!-- Modal para el Golf Cart -->
            <div id="golfCartModal" class="modal">
                <div class="modal-content">
                    <span class="close" data-modal="golfCart">&times;</span>
                    <h2>Golf Cart Information</h2>
                    
                    <div class="info-section">
                        <h3>Charging Instructions</h3>
                        <p>The golf cart has a retractable cord on the back for charging. Please make sure to
                        retract it when in use so it is not hanging loose and gets damaged.</p>
                    </div>

                    <div class="info-section">
                        <h3>Golf Cart Parking</h3>
                        <p>Park your cart at its designated parking space and appropriate parking at the different resort venues:</p>
                        <ul>
                            <li>Wellness Center</li>
                            <li>Boathouse/ Water Park</li>
                            <li>Beach Club pools, restaurants, concierge and golf shop</li>
                            <li>Cocoteros Diner</li>
                            <li>Sand Dollar Beach</li>
                            <li>Valet parking at the St. Regis Hotel</li>
                        </ul>
                    </div>

                    <div class="info-section warning">
                        <h3>Rules and Regulations</h3>
                        <ul>
                            <li>It's prohibited for kids and adults with no driver's license to drive the golf cart</li>
                            <li>Kids aren't allowed to drive, not even with an adult on the side or carrying them on the laps</li>
                            <li>Excessive speeding, joy riding, golf course or golf course path riding, beach, sand or offroad riding, disregard of traffic signs, or any type of unreasonable activity with the golf cart will be tolerated by the development</li>
                        </ul>
                        <p class="warning-text">Local security enforces these restrictions with a fine and you will not be able to use the golf cart for the reminder of the stay.</p>
                    </div>
                </div>
            </div>

            <!-- Modal para Golf Rates -->
            <!-- Modal para Golf Shop -->
            <div id="golfRatesModal" class="modal" data-modal-type="golf-shop">
                <div class="modal-content">
                    <span class="close" data-modal="golfRates">&times;</span>
                    <h2>Golf Shop - Rates and Information</h2>
                    <!-- Verificación de carga del modal -->
                    <script>
                        console.log('Golf Shop modal loaded:', {
                            id: 'golfRatesModal',
                            exists: !!document.getElementById('golfRatesModal'),
                            classes: document.getElementById('golfRatesModal')?.className
                        });
                    </script>
                    
                    <div class="table-responsive">
                        <table>
                            <caption>GOLF RATES (18 HOLES)</caption>
                            <thead>
                              <tr>
                                <th colspan="8">Weekends</th>
                              </tr>
                              <tr>
                                <th></th>
                                <th></th>
                                <th>Discount Rate for Renters with Day Pass</th>
                                <th>TOTAL WITH TAXES (11.5%)</th>
                                <th>Regular Rate</th>
                                <th>TOTAL WITH TAXES (11.5%)</th>
                                <th>JUNIORS (Up to 15 years)</th>
                                <th>TOTAL WITH TAXES (11.5%)</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <th>7:00 AM</th>
                                <td>10:50 AM</td>
                                <td>$279.00</td>
                                <td>$311.09</td>
                                <td>$295.00</td>
                                <td>$328.93</td>
                                <td>Flat Rate $75</td>
                                <td>$83.63</td>
                              </tr>
                              <tr>
                                <th>11:00 AM</th>
                                <td>1:50 PM</td>
                                <td>$189.00</td>
                                <td>$210.74</td>
                                <td>$225.00</td>
                                <td>$250.88</td>
                                <td>Flat Rate $75</td>
                                <td>$83.63</td>
                              </tr>
                              <tr>
                                <th>2:00 PM</th>
                                <td>-</td>
                                <td>$169.00</td>
                                <td>$188.54</td>
                                <td>$195.00</td>
                                <td>$217.43</td>
                                <td>Flat Rate $75</td>
                                <td>$83.63</td>
                              </tr>
                            </tbody>
                            <thead>
                              <tr>
                                <th colspan="8">Weekdays</th>
                              </tr>
                              <tr>
                                <th></th>
                                <th></th>
                                <th>Discount Rate</th>
                                <th>TOTAL WITH TAXES (11.5%)</th>
                                <th>Regular Rate</th>
                                <th>TOTAL WITH TAXES (11.5%)</th>
                                <th>JUNIORS (Up to 15 years)</th>
                                <th>TOTAL WITH TAXES (11.5%)</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <th>7:00 AM</th>
                                <td>10:50 AM</td>
                                <td>$225.00</td>
                                <td>$250.88</td>
                                <td>$239.00</td>
                                <td>$266.49</td>
                                <td>Flat Rate $75</td>
                                <td>$83.63</td>
                              </tr>
                              <tr>
                                <th>11:00 AM</th>
                                <td>1:50 PM</td>
                                <td>$225.00</td>
                                <td>$250.88</td>
                                <td>$239.00</td>
                                <td>$266.49</td>
                                <td>Flat Rate $75</td>
                                <td>$83.63</td>
                              </tr>
                              <tr>
                                <th>2:00 PM</th>
                                <td>-</td>
                                <td>$169.00</td>
                                <td>$188.44</td>
                                <td>$175.00</td>
                                <td>$195.13</td>
                                <td>Flat Rate $75</td>
                                <td>$83.63</td>
                              </tr>
                            </tbody>
                            <tfoot>
                              <tr>
                                <td colspan="8">Golf Clubs Rental: $85.00 each (Plus Taxes 11.5%) = $94.78 (TOTAL)</td>
                              </tr>
                            </tfoot>
                        </table>
                    </div>
                    <p class="rates-note">* Rates are subject to change. Please confirm with the golf pro shop.</p>
                </div>
            </div>

            <!-- Modal para Tennis -->
            <div id="tennisModal" class="modal">
                <div class="modal-content">
                    <span class="close" data-modal="tennis">&times;</span>
                    <h2>Tennis Services</h2>
                    
                    <div class="info-section">
                        <h3>Court Reservations</h3>
                        <p><strong>Complementary with your resort fee</strong></p>
                        <ul class="info-list">
                            <li>Four tennis courts available:
                                <ul>
                                    <li>Clay Courts: #1 and #3</li>
                                    <li>Hard Courts: #2 and #4</li>
                                </ul>
                            </li>
                            <li>Reservations:
                                <ul>
                                    <li>Choose your preferred day and time</li>
                                    <li>Bahia Beach will check court availability</li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>Tennis Lessons</h3>
                        <ul class="info-list">
                            <li>Rate: $150 (Non-Members)</li>
                            <li>Scheduling:
                                <ul>
                                    <li>Choose your preferred day and time</li>
                                    <li>Bahia Beach will verify instructor availability</li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>Tennis Clinics</h3>
                        <ul class="info-list">
                            <li>Rate: $40 (Non-Members)</li>
                        </ul>
                    </div>

                    <p class="rates-note">* Tennis lessons and clinics rates are subject to change and do not include Puerto Rico Tax (11.5%)</p>
                </div>
            </div>

            <!-- Modal para Kids Club -->
            <div id="kidsClubModal" class="modal">
                <div class="modal-content">
                    <span class="close" data-modal="kidsClub">&times;</span>
                    <h2>👦 🐢 St. Regis Tortuga Kid's Club</h2>
                    
                    <div class="info-section">
                        <h3>About Tortuga Kid's Club</h3>
                        <p>As part of the Family Traditions program at St. Regis, The Tortuga Kid's Club incorporates an educationally based St. Regis children's play center and video games for older children while a separate area offers a variety of stimulating activities for younger children.</p>
                        <p>Children are welcome to access the club with a parent or enroll their children as often as they wish, based on program availability.</p>
                    </div>

                    <div class="info-section">
                        <h3>Hours of Operation</h3>
                        <ul class="info-list">
                            <li>Monday – Sunday: 10:00 am - 5:00 pm</li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>Rates</h3>
                        <ul class="info-list">
                            <li>One Hour: $30.00 USD per child</li>
                            <li>Two Hours: $45.00 USD per child</li>
                            <li>Half Day: $75.00 USD per child (Snack Included)</li>
                            <li>Four Hours: $90.00 USD per child</li>
                            <li>Full Day: $125.00 per child (Lunch and Snack Included)</li>
                            <li>Additional Half Hour: $15.00 USD per child</li>
                        </ul>
                        <p class="rates-note">* All rates are subject to taxes and gratuity</p>
                    </div>

                    <div class="info-section warning">
                        <h3>Important Information</h3>
                        <ul class="info-list">
                            <li>Charges apply when children enjoy Tortuga Kid's Club program under recreation attendants' supervised childcare services</li>
                            <li>Every Child participating in the program must be at least four (4) years old and no older than twelve (12) years old</li>
                            <li>Every child participating in the program must be fully potty trained and must be able to re-dress themselves without assistance</li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>Additional Services</h3>
                        <ul class="info-list">
                            <li>Babysitting services are arranged through the St. Regis Concierge</li>
                            <li>Tortuga Kid's Club facilities are complimentary when children are accompanied by a guardian</li>
                        </ul>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script type="module">
        // Importar las dependencias necesarias
        import { initializeProperty } from '../../js/propertyRenderer.js';
        import { zoomIn, zoomOut, resetZoom } from '../../js/modals.js';

        // Configurar los botones de zoom cuando el documento esté listo
        document.addEventListener('DOMContentLoaded', () => {
            const zoomInBtn = document.getElementById('zoomInBtn');
            const zoomOutBtn = document.getElementById('zoomOutBtn');
            const resetZoomBtn = document.getElementById('resetZoomBtn');

            if (zoomInBtn) zoomInBtn.addEventListener('click', zoomIn);
            if (zoomOutBtn) zoomOutBtn.addEventListener('click', zoomOut);
            if (resetZoomBtn) resetZoomBtn.addEventListener('click', resetZoom);
        });
        

        // Inicializar el mapa cuando se abre el modal
      
        import * as modalFunctions from '../../js/modals.js';

        // Hacer las funciones modales disponibles globalmente
        Object.assign(window, modalFunctions);

        // Inicializar la propiedad
        document.addEventListener('DOMContentLoaded', () => {
            // Configurar manejadores de eventos para los botones de cierre
            document.querySelectorAll('.close').forEach(button => {
                button.addEventListener('click', () => {
                    const modalType = button.getAttribute('data-modal');
                    switch(modalType) {
                        case 'golfCart':
                            closeGolfCartModal();
                            break;
                        case 'golfRates':
                            closeGolfRatesModal();
                            break;
                        case 'tennis':
                            closeTennisModal();
                            break;
                        case 'kidsClub':
                            closeKidsClubModal();
                            break;
                    }
                });
            });
            initializeProperty();
            
            // Configurar los event listeners para el modal del mapa
            const openMapBtn = document.getElementById('openMapButton');
            const closeMapBtn = document.getElementById('closeMapButton');
            
            if (openMapBtn) openMapBtn.addEventListener('click', openMapModal);
            if (closeMapBtn) closeMapBtn.addEventListener('click', closeMapModal);
        });

        // Esperar a que el DOM esté completamente cargado
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Inicializar la propiedad
                await initializeProperty();
                console.log('Propiedad inicializada correctamente');

                // Cargar el script principal
                await import('../../../script.js');
                console.log('Script principal cargado correctamente');

                // Verificar los modales
                const modals = document.querySelectorAll('.modal');
                console.log('Modales encontrados:', modals.length);
            } catch (error) {
                console.error('Error durante la inicialización:', error);
            }
        });
    </script>
</body>
</html>
